#!/bin/bash
#Valido trailer

file="./arribos/Entregas_04.txt"

validar_trailer(){
file=$1
contador=0
IFS=$'\n'
SUM_COD_POSTAL=0
for registro in $( cat $file )
	do
		COD_POSTAL=`echo $registro | cut -d ";" -f6`
		OPERADOR=`echo $registro | cut -d ";" -f1`
		contador=$((contador+1))
		if [ ${contador} != 1 ] && [ "${#OPERADOR}" -eq 0 ]
			then
			SUM_COD_POSTAL=$(expr $SUM_COD_POSTAL + $COD_POSTAL)
			echo $COD_POSTAL		
		fi
		if [ ${#OPERADOR} -eq 0 ]
			then
			TRAILER=`echo $registro | cut -d ";" -f6`
			Q_REGISTROS=`echo $registro | cut -d ";" -f5`
		fi
	done

VER_TRAILER=$(expr $SUM_COD_POSTAL - $TRAILER)

if [ ${VER_TRAILER} -eq 0 ]
	then
		echo "Verificacion de trailer TRUE"
	else
		echo "Verificaion de trailer FALSE"
	fi

echo "Cantidad de regitros: $Q_REGISTROS"
echo "Suma de codigos $SUM_COD_POSTAL"
echo "TRAILER: $TRAILER"
}

validar_trailer $1
