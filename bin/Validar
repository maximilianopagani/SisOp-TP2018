#!/bin/bash

#Funcion para verificar que el nombre del archivo sea correcto
#Funcion para validar el nombre del archivo de acuerdo a los archivos MAESTROS
#correcto: <cod_gestion>_<cod_norma>_<cod_emisor>_<Nro_archivo>_<fecha>


#CONDICION 1: 
#Esta rutina valida que el nombre del archivo cumpla con el Formato especificado
#Entregas_XX
#XX = 01,02.03,04,05,06,07,08,09,10,11,12
NOMBRE_VALIDO="F"
MES=""
ANTIGUO="F"
MES_ACTUAL=0
MES_ARCH=0
MES_OK=""
name=""

validar_nombre(){

	NOMBRE_VALIDO="F"
	Qchar="F"
	M="F"
	N="F"


	file_name="$1"

	Extension=$(echo $file_name | cut -d '.' -f 2)

	if [ "${Extension}" != "txt" ]
		then
			NOMBRE_VALIDO="F"
		else
			name=$(echo $file_name | cut -d '.' -f 1)
			nombre=$(echo $name | cut -d '_' -f 1)
			MES=$(echo $name | cut -d '_' -f 2)
	
			if [ ${#file_name} == 15 ];then
				Qchar="V"
			fi	
	  		case $MES in
			01)
			M="V"
			;;
			02)
			M="V"
			;;
			03)
			M="V"
			;;	
			04)
			M="V"
			;;	
			05)
			M="V"
			;;	
			06)
			M="V"
			;;	
			07)
			M="V"
			;;	
			08)
			M="V"
			;;	
			09)
			M="V"
			;;	
			10)
			M="V"
			;;	
			11)
			M="V"
			;;	
			12)
			M="V"
			;;
			*)
			M="F"
			;;	
			esac
			if [ "${nombre}" == "Entregas" ];then
				N="V"
			fi
			if [ "${Qchar}" == "V" ] && [ "${M}" == "V" ] && [ "${N}" == "V" ];then
				NOMBRE_VALIDO="V"
			fi
		fi
}

validar_mes_Arch(){

	MES_ACTUAL=$(date +%m)
	MES=$(echo $name | cut -d '_' -f 2)
	#MES_ACTUAL="10"
	echo "mes: $mes"	
	diferencia=`expr ${MES_ACTUAL} - ${MES}`	
	if [ $diferencia -ge 0 ]
	then
		MES_OK="V"
		else	
		MES_OK="F"
	fi
}	







#Nombres Validos Entregas_XX
#XX:01-12 Codigo de mes.
validar_nombre $1
validar_mes_Arch $1

if [ "${MES_OK}" == "V" ]
	then
	echo "MES OK"
	fi

if [ "${NOMBRE_VALIDO}" == "V" ]
	then
	echo "Nombre Valido"
	fi









